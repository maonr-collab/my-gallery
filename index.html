<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>הגלריה שלי</title>
  <style>
    body {
      margin: 0;
      font-family: 'Assistant', sans-serif;
      background: #111;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
    }
    .slideshow {
      position: relative;
      width: 90%;
      height: 90%;
      max-width: 1000px;
      background: #000;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 0 30px rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    .slide {
      display: none;
      width: 100%;
      height: 100%;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      position: relative;
      animation: fadeIn 1s;
    }
    .slide.active { display: flex; }
    .slide img, .slide video, .slide iframe {
      max-width: 100%;
      max-height: 80%;
      object-fit: contain;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }
    .caption {
      position: absolute;
      bottom: 0;
      width: 100%;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      color: #fff;
      padding: 15px 20px;
      background: rgba(0,0,0,0.5);
      text-shadow: 2px 2px 10px rgba(0,0,0,0.9);
      border-top: 2px solid #444;
      opacity: 0;
      animation: fadeCaption 1s forwards;
      direction: rtl;
      line-height: 1.4;
    }
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    @keyframes fadeCaption {
      from {opacity: 0; transform: translateY(20px);}
      to {opacity: 1; transform: translateY(0);}
    }
    .controls {
      position: absolute;
      top: 50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
      padding: 0 20px;
      z-index: 10;
    }
    .btn {
      background: rgba(0,0,0,0.5);
      border: none;
      color: white;
      font-size: 30px;
      cursor: pointer;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      transition: 0.3s;
    }
    .btn:hover { background: rgba(255,255,255,0.3); color: #000; }
  </style>
</head>
<body>
  <div class="slideshow" id="slideshow">
    <div class="controls">
      <button class="btn prev" onclick="prevSlide()">&#10094;</button>
      <button class="btn next" onclick="nextSlide()">&#10095;</button>
    </div>
    <div id="yt-player" style="display:none;"></div>
  </div>
  
  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    let slides = [];
    let currentIndex = 0;
    const extendedCaptions = [
      {
        text: "כאן מופיע טקסט מורחב על פני 3 שקופיות, בעברית, עם אפקט מקצועי",
        startSlide: 0,
        endSlide: 2,
        style: {
          fontSize: "28px",
          color: "#FFD700",
          textShadow: "2px 2px 10px rgba(0,0,0,0.9)",
          background: "rgba(0,0,0,0.5)"
        }
      }
    ];

    const repo = "maonr-collab/my-gallery";   // שם המשתמש והרפו
    const path = "assets";                     // תיקיית הקבצים
    const token = "PASTE_YOUR_TOKEN_HERE";     // Personal Access Token

    async function loadSlides() {
      const apiUrl = `https://api.github.com/repos/${repo}/contents/${path}`;
      const res = await fetch(apiUrl, { headers: { Authorization: `token ${token}` }});
      const files = await res.json();
      const container = document.getElementById("slideshow");

      files.forEach(file => {
        const ext = file.name.split('.').pop().toLowerCase();
        let name = file.name.replace(/\.[^/.]+$/, '').replace(/_/g,' ').replace(/\b\w/g, c => c.toUpperCase());

        const slide = document.createElement("div");
        slide.className = "slide";

        let media;
        if (["jpg","jpeg","png","gif","webp"].includes(ext)) {
          media = document.createElement("img");
          media.src = file.download_url;
        } else if (["mp4","webm"].includes(ext)) {
          media = document.createElement("video");
          media.src = file.download_url;
          media.controls = true;
        } else if (ext === "pdf") {
          media = document.createElement("iframe");
          media.src = file.download_url;
        } else return;

        slide.appendChild(media);

        const captionOverlay = document.createElement("div");
        captionOverlay.className = "caption";
        captionOverlay.textContent = name;
        slide.appendChild(captionOverlay);

        container.appendChild(slide);
        slides.push({element: slide, caption: name, captionOverlay});
      });

      if(slides.length) showSlide(0);
      setInterval(() => showSlide(currentIndex + 1), 6000);

      initYouTubeBackground("VIDEO_ID"); // הכנסי את ID של השיר מיוטיוב
    }

    function showSlide(n) {
      if(slides.length === 0) return;
      slides[currentIndex].element.classList.remove("active");

      currentIndex = (n + slides.length) % slides.length;
      slides[currentIndex].element.classList.add("active");

      const extended = extendedCaptions.find(c => currentIndex >= c.startSlide && currentIndex <= c.endSlide);
      slides.forEach(s => s.captionOverlay.style.opacity = 0);
      if(extended) {
        slides[currentIndex].captionOverlay.textContent = extended.text;
        Object.assign(slides[currentIndex].captionOverlay.style, extended.style);
      } else {
        slides[currentIndex].captionOverlay.textContent = slides[currentIndex].caption;
        slides[currentIndex].captionOverlay.style.opacity = 1;
      }
    }

    function nextSlide() { showSlide(currentIndex + 1); }
    function prevSlide() { showSlide(currentIndex - 1); }

    let player;
    function initYouTubeBackground(videoId) {
      window.onYouTubeIframeAPIReady = function() {
        player = new YT.Player('yt-player', {
          height: '0',
          width: '0',
          videoId: videoId,
          playerVars: { autoplay: 1, controls: 0, loop: 0, rel:0 },
          events: { 'onReady': e => e.target.playVideo() }
        });
      };
    }

    loadSlides();
  </script>
</body>
</html>
